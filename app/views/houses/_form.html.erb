<script type="text/javascript">
  $(document).ready(function(){
    $('#opened_date').datepicker({ dateFormat: "yy-mm-dd"});
  });
</script>
<div class="row">
<div class="span3">
  <div id="tabs">
	  <ul class="nav nav-tabs nav-stacked affix" id="leftnav">
	    <li><a href="#location"><i class="icon-chevron-right"></i> Location</a></li>
	    <li><a href="#mailing"><i class="icon-chevron-right"></i> Mailing</a></li>
	    <li><a href="#contact"><i class="icon-chevron-right"></i> Contact</a></li>
	    <li><a href="#rent"><i class="icon-chevron-right"></i> Rent</a></li>
	    <li><a href="#financial"><i class="icon-chevron-right"></i> Financial</a></li>      
      <li><a href="#save"><i class="icon-chevron-right"></i>Options</a></li>
	    <% if params[:action] != "new"%><li><a href="#residents"><i class="icon-chevron-right"></i> Residents</a></li><% end %>
      
	  </ul>
  </div>
</div>
<div class="span9">
<%= form_for @house, :html => { :class => 'form-horizontal', :multipart => true } do |f| %>
<section class="section-with-margin" id="location">
  <fieldset>
	<legend>Location</legend>
	<div class="row">
		<div class="span4">
			  <div class="control-group">
			    <%= f.label :opened_date, :class => 'control-label' %>
			    <div class="controls">
			        <%= f.text_field :opened_date, :class => 'input-large', :id => 'opened_date' %>
			    </div>
			  </div>
			  <div class="control-group">
			    <%= f.label :city, :class => 'control-label' %>
			    <div class="controls">
			      <%= f.text_field :city, :class => 'input-large' %>
			    </div>
			  </div>
			  <div class="control-group">
			    <%= f.label :state, "State/Country", :class => 'control-label' %>
			    <div class="controls">
			      <%= f.text_field :state, :prompt => "Put country if outside U.S.", :class => 'input-large' %>
			    </div>
			  </div>
			  <div class="control-group">
			    <%= f.label :region, :class => 'control-label' %>
			    <div class="controls">
			      <%= f.select :region, region_array, :prompt => "Select Region", :class => 'input-large' %>
			    </div>
			  </div>
			  <div class="control-group">
			    <%= f.label :web_description, :class => 'control-label' %>
			    <div class="controls">
			      <%= f.text_area :web_description, :class => 'text_area', :rows => 4 %>
			    </div>
			  </div>
			  <div class="control-group">
			    <%= f.label :brn, 'BRN', :class => 'control-label' %>
			    <div class="controls">
			      <%= f.check_box :brn, :class => 'check_box' %>
			    </div>
			  </div>
			  <div class="control-group">
			    <%= f.label :rsj, 'RSJ', :class => 'control-label' %>
			    <div class="controls">
			      <%= f.check_box :rsj, :class => 'check_box' %>
			    </div>
			  </div>
			  <div class="control-group">
			    <%= f.label :featured, 'Featured', :class => 'control-label' %>
			    <div class="controls">
			      <%= f.check_box :featured, :class => 'check_box' %>
			    </div>
			  </div>
			  <div class="control-group">
			    <%= f.label :active, :class => 'control-label' %>
			    <div class="controls">
			      <%= f.check_box :active, :checked => true, :class => 'check_box' %>
			    </div>
			  </div>
		</div>
		<div class="span3 offset1">
			    <ul class="thumbnails">
				  <li class="span2 offset3">
				    <div class="thumbnail">
				      <%= image_tag @house.avatar, :width => "160"%>
				      <h3>Photo</h3>
					  <p class="text-center">
						<%= f.file_field :avatar %>						
					  </p>
				    </div>
				  </li>
				</ul>
		</div>
	</div>	
  </fieldset>
</section>
<section class="section-with-margin" id="mailing">
  <fieldset>
	<legend>Mailing Info</legend>
  <div class="control-group">
    <%= f.label :mail_address, "Address", :class => 'control-label' %>
    <div class="controls">
      <%= f.text_field :mail_address, :class => 'input-large' %>
    </div>
  </div>
  <div class="control-group">
    <%= f.label :mail_city, "City", :class => 'control-label' %>
    <div class="controls">
      <%= f.text_field :mail_city, :class => 'input-large' %>
    </div>
  </div>
  <div class="control-group">
    <%= f.label :mail_state, "State", :class => 'control-label' %>
    <div class="controls">
      <%= f.text_field :mail_state, :class => 'input-large' %>
    </div>
  </div>
  <div class="control-group">
    <%= f.label :mail_zip, "Zip", :class => 'control-label' %>
    <div class="controls">
      <%= f.text_field :mail_zip, :class => 'input-large' %>
    </div>
  </div>
  <div class="control-group">
    <%= f.label :mail_instructions, "Instructions", :class => 'control-label' %>
    <div class="controls">
      <%= f.text_area :mail_instructions, :class => 'text_area', :rows => 4 %>
    </div>
  </div>
  <div class="control-group">
    <%= f.label :mail_international, "International", :class => 'control-label' %>
    <div class="controls">
      <%= f.check_box :mail_international, :class => 'check_box' %>
    </div>
  </div>
  <div class="control-group">
    <%= f.label :director_id, :class => 'control-label' %>
    <div class="controls">
      <%= f.select :director_id, User.where("house_id = 11").order("first_name").map {|i| [i.firstlast, i.id]}, :prompt => "Select Director", :class => 'input-large' %>
    </div>
  </div>
</fieldset>
</section>
<section class="section-with-margin" id="contact">
  <fieldset>
	<legend>Contact Info</legend>
  <div class="control-group">
    <%= f.label :contact_phone, :class => 'control-label' %>
    <div class="controls">
      <%= f.text_field :contact_phone, :class => 'input-large' %>
    </div>
  </div>
  <div class="control-group">
    <%= f.label :contact_email, :class => 'control-label' %>
    <div class="controls">
      <%= f.text_field :contact_email, :class => 'input-large' %>
    </div>
  </div>
  <div class="control-group">
    <%= f.label :website, :class => 'control-label' %>
    <div class="controls">
      <div class="input-prepend">
        <span class="add-on">http://</span >
        <%= f.text_field :website, :class => 'input-large' %>
      </div>
    </div>
  </div>
  <div class="control-group">
    <%= f.label :calendar, :class => 'control-label' %>
    <div class="controls">
      <div class="input-prepend">
        <span class="add-on">http://</span >
      <%= f.text_field :calendar, :class => 'input-large' %>
	  </div>
    </div>
  </div>
</fieldset>
</section>

<section class="section-with-margin" id="rent">
<fieldset>
	<legend>Rent Info</legend>
  <div class="control-group">
    <%= f.label :rent_name_on_check, :class => 'control-label' %>
    <div class="controls">
      <%= f.text_field :rent_name_on_check, :class => 'input-large' %>
    </div>
  </div>
  <div class="control-group">
    <%= f.label :rent_address, :class => 'control-label' %>
    <div class="controls">
      <%= f.text_field :rent_address, :class => 'input-large' %>
    </div>
  </div>
  <div class="control-group">
    <%= f.label :rent_city, :class => 'control-label' %>
    <div class="controls">
      <%= f.text_field :rent_city, :class => 'input-large' %>
    </div>
  </div>
  <div class="control-group">
    <%= f.label :rent_state, :class => 'control-label' %>
    <div class="controls">
      <%= f.text_field :rent_state, :class => 'input-large' %>
    </div>
  </div>
  <div class="control-group">
    <%= f.label :rent_zip, :class => 'control-label' %>
    <div class="controls">
      <%= f.text_field :rent_zip, :class => 'input-large' %>
    </div>
  </div>
  <div class="control-group">
    <%= f.label :rent_instructions, :class => 'control-label' %>
    <div class="controls">
      <%= f.text_area :rent_instructions, :class => 'text_area', :rows => 4 %>
    </div>
  </div>
  <!-- <div class="control-group">
    <%#= f.label :rent_name, :class => 'control-label' %>
    <div class="controls">
      <%#= f.text_field :rent_name, :class => 'input-large' %>
    </div>
  </div> -->
</fieldset>
</section>
<section class="section-with-margin" id="financial">
<fieldset>
	<legend>Financial Info</legend>
  <div class="control-group">
    <%= f.label :programs_per_month, :class => 'control-label' %>
    <div class="controls">
      <%= f.select :programs_per_month, [['3-4 Programs/Month', 1], ['5-6 Programs/Month', 2], ['7+ Programs/Month', 3]], :prompt => "Select Type", :class => 'input-large' %>
    </div>
  </div>
  <div class="control-group">
    <%= f.label :rent_total, :class => 'control-label' %>
    <div class="controls">
	  <div class="input-prepend">
        <span class="add-on">$</span >
      <%= f.text_field :rent_total, :class => 'input-small' %>
	  </div>
    </div>
  </div>
  <div class="control-group">
    <%= f.label :rent_subsidy, :class => 'control-label' %>
    <div class="controls">
	  <div class="input-prepend">
        <span class="add-on">$</span>
      <%= f.text_field :rent_subsidy, :class => 'input-small' %>
	  </div>
    </div>
  </div>
  <div class="control-group">
    <%= f.label :budget_program, 'Program Budget', :class => 'control-label' %>
    <div class="controls">
	  <div class="input-prepend">
        <span class="add-on">$</span>
      <%= f.text_field :budget_program, :class => 'input-small' %>
      </div>
    </div>
  </div>
  <div class="control-group">
    <%= f.label :budget_cleaning, 'Cleaning Budget', :class => 'control-label' %>
    <div class="controls">
	  <div class="input-prepend">
        <span class="add-on">$</span>
      <%= f.text_field :budget_cleaning, :class => 'input-small' %>
	  </div>
    </div>
  </div>
</fieldset>
</section>
<section class="section-with-margin" id="save">
  <fieldset>  
    <legend>Save</legend>
    <div class="form-actions">
      <%= f.submit 'Save', :class => 'btn btn-large btn-block btn-primary' %>
      <%= link_to t('.cancel', :default => t("helpers.links.cancel")),
                  houses_path, :class => 'btn btn-large btn-block' %><br><br>
      <%= link_to "Delete House", "/houses/destroy/" + @house.id.to_s, :method => :delete, :data => { :confirm => t('.confirm', :default => t("helpers.links.confirm", :default => 'Are you sure?')) }, :class => 'btn btn-large btn-danger btn-block' %>
    </div>  
  </fieldset>
</section>

<% if params[:action] != "new"%>
<section class="section-with-margin" id="residents">
<fieldset>
	<legend>Residents</legend>
	  <table class="table table-striped">
    <thead>
      <tr>
        <th>Name</th>
        <th>Photo</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      <% @house.residents.where("active = true").order("last_name").each do |u| %>
        <tr class="success">
          <td><%= u.fullname %><br /><span class="label label-success">Current</span></td>
          <td>
	      <% if u.avatar.to_s == "missing.png"%>
			<%= link_to (image_tag "http://moishehouse.org/data/photos/residents/" + u.id.to_s + ".jpg", :size => "50x50", :class => "img-polaroid"), "http://moishehouse.org/data/photos/residents/" + u.id.to_s + ".jpg" %>
		  <% else %>
			<%= image_tag u.avatar, :size => "50x50", :class => "img-polaroid" %>
		  <% end %>
			</td>
          <td>
            <%= link_to "Edit",
                        "/users/edit/#{u.id}", :class => 'btn btn-medium' %>
          </td>
        </tr>
      <% end %>
      <% @house.residents.where("active = false").order("last_name").each do |u| %>
        <tr class="warning">
          <td><%= u.fullname %><br /><span class="label label-warning">Alumni</span></td>
          <td>
	      <% if u.avatar.to_s == "missing.png"%>
			<%= link_to (image_tag "http://moishehouse.org/data/photos/residents/" + u.id.to_s + ".jpg", :size => "50x50", :class => "img-polaroid"), "http://moishehouse.org/data/photos/residents/" + u.id.to_s + ".jpg" %>
		  <% else %>
			<%= image_tag u.avatar, :size => "50x50", :class => "img-polaroid" %>
		  <% end %>
			</td>
          <td>
            <%= link_to "Edit",
                        "/users/edit/#{u.id}", :class => 'btn btn-medium' %>
          </td>
        </tr>
      <% end %>
    </tbody>
  </table>
</fieldset>  

</section>
<% end %>
</div>
</div>
<% end %>
